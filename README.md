# genus2isogenies


# Computation of isogeny classes
The computation of isogeny classes from invariants can be on
 - [SageMath](https://www.sagemath.org/)
 - [pyhdme](https://github.com/edgarcosta/pyhdme)
```
  sage -pip install --upgrade git+https://github.com/edgarcosta/pyhdme
```
 
and optionally on:
 - [Pari/GP](https://pari.math.u-bordeaux.fr/) >= 2.15.0, precisely `hyperellminimalmodel` and `hyperellred`
 - [Magma](http://magma.maths.usyd.edu.au/magma/), precisely `ReducedModel`
- [wrapt-timeout-decorator](https://pypi.org/project/wrapt-timeout-decorator/)
```
sage -pip install wrapt-timeout-decorator
```
to provide models with reasonable coefficient size.
 

## Examples

See [data/README.md](data/README.md) for a description of the input/output.

### A pair connected by an isogeny of degree 3^4
```
$ sage -python genus2isogenies.py "704:704.a:2159575534599616393:[[-1856,129536,-44,-2948]]:[[[-1,-1,-2,1,1,-2],[1,1,1,1]]]"
704:704.a:2159575534599616393:[[-1856,129536,-44,-2948]]:[[[-1,-1,-2,1,1,-2],[1,1,1,1]]]:[2,3]:[[-1856,129536,-44,-2948],[771904,687149056,260876,-197548868]]:[[[0,4,4,-1,-2],[0,0,0,1]],[[-1140,-5166,-4646,2135,-236,4],[1]]]:[[0,9],[9,0]]
```

### An example where we search for isogenies of degree 29^2 and 29^4
In this we recommend using higher number of threads, e.g., 12:
```
$ sage -python genus2isogenies.py "976:976.a:78262366554954104:[[1012,52318,-976,-37088]]:[[[1,2,0,-2,-1,-1],[0,0,1,1]]]" 12
976:976.a:78262366554954104:[[1012,52318,-976,-37088]]:[[[1,2,0,-2,-1,-1],[0,0,1,1]]]:[29]:[[1012,52318,-976,-37088]]:[[[1,-2,0,2,-1],[0,0,1,1]]]:[[0]]
```

### An example of of square with isogenies of degree 3^4 and 5^4
```
$ sage -python genus2isogenies.py "277:277.a:639653774064676620:[[1408,49024,-277,-8864],[5482048,12835476224,277,-620480]]:[[[0,-1,-1],[1,1,1,1]],[[-6,11,-19,14,-9,1],[1]]]"
277:277.a:639653774064676620:[[1408,49024,-277,-8864],[5482048,12835476224,277,-620480]]:[[[0,-1,-1],[1,1,1,1]],[[-6,11,-19,14,-9,1],[1]]]:[3,5]:[[-4074752,3079190656,-53383717,155880885760],[1408,49024,-277,-8864],[5482048,12835476224,277,-620480],[5786446528,440253117070336,-3537013,285292529056]]:[[[-10406,-10383,5266,7578,169,-1396,-252],[0,0,0,1]],[[0,0,-1,-2,0,-1],[1,1,1,1]],[[0,1,-9,14,-19,11,-6],[0,0,0,1]],[[-14580,-51520,-63684,-31054,-3823,637,-18],[1]]]:[[0,25,0,9],[25,0,9,0],[0,9,0,25],[9,0,25,0]]
```
and now without reducing the models:
```
$ sage -python genus2isogenies.py "277:277.a:639653774064676620:[[1408,49024,-277,-8864],[5482048,12835476224,277,-620480]]:[[[0,-1,-1],[1,1,1,1]],[[-6,11,-19,14,-9,1],[1]]]" 1 0 0
277:277.a:639653774064676620:[[1408,49024,-277,-8864],[5482048,12835476224,277,-620480]]:[[[0,-1,-1],[1,1,1,1]],[[-6,11,-19,14,-9,1],[1]]]:[3,5]:[[-4074752,3079190656,-53383717,155880885760],[1408,49024,-277,-8864],[5482048,12835476224,277,-620480],[5786446528,440253117070336,-3537013,285292529056]]:[[[-28096,-2079104,-38660096,590016,74917984,-106761288,45353968],[]],[[4,-8,12,-16,-4,8,4],[]],[[-92,176,-304,224,-144,16],[]],[[-517408348857836510889848334763901449567671426754851815052565536728554136710140844454365296210324145862357726643908236293092780063804424,-805393427983763130873482911499363387924011402123072613773617171039035220994888283493205982887271828103607796532904226435324090752065202293503819483293547397550566505397672,-522361895325142681864409737866028358675768189806764122927918958722173787664104616471777516588877426313282415509150333019512483098223782928990662669539996073256588336906218466108119554170849294274407772318480,-180689794714458493461498992507308796329608747620881928007006502486292765827032535045739581858224049078798462466438008090771144183103905743762056698643522921512212390973972482718414565206752539574047045394361723265970365340890886815198528767568,-35157524392485475082729183235657454489779711065955036415942304802667088184945185064918657476092302610247344143226954504393765181469219889111514969686867491527668462716435977442582934739942013633714828355913406561371208083581627341768830950604060665944120658291295404720062167464,-3648393530614980651591261229330133033034825854986404817955450872603402551875167224274735007576756107872086307991682095308318293016544874812085857822317950310500613720478040585378942663954571513650943629142022375297655685027850089254964458302977483452000156617090735592056768850674779683856483844542603097179305224,-157751619132279216256502494282855298751305551246736375468265654872244834968153005341133513420479506142935139637600281343284008669984341847612887053316520198753757259626642747182055799153483978464960981062827047602780866875434427594853618610293080724449922202743521089843503699436614384768877896742109731700503196948152403665330318088493912687640576],[]]]:[[0,25,0,9],[25,0,9,0],[0,9,0,25],[9,0,25,0]]
```


### An example with isogeny graph of size 42
```
sage -python genus2isogenies.py "2084783416934400:None:0:[[12279421902241,27720894398734429039,-425954713866501456000000,3620409974473702743642699000000]]:[[[2288,-14840,12679,37445,11208,720],[]]]"
2084783416934400:None:0:[[12279421902241,27720894398734429039,-425954713866501456000000,3620409974473702743642699000000]]:[[[2288,-14840,12679,37445,11208,720],[]]]:[2]:[[-3748458025135679,694225931974496339453119,619920649486901346282562500,30351145841140999930007171039437500],[-575638324559759,12286578492875215682839,13102016470383120462000,-224839864777508695166428548000],[-406141282135679,3744876437299379753119,29722918120155643304391992437500,-1217542684354332972753303259813664437500],[-80383490035679,12397649316423490763119,-44463027549129080104213745062500,544326914049434484048879587803148062500],[-39130396949519,224771934218746336471,33504097249407565334531250000,-22901535216381088086967495237500000],[-29736646361519,237523650827887409671,-12179105721334563475668750000,363917869213050132126420492562500000],[-24969123696959,2414177579327779329281,-541688943980706749807580000,-16675118661876865484907715025625000],[-24387851335679,148304114802468233119,42367380329452423095703125000,-95051345113366815740778808593750000],[-20449399330559,51062407712928219041,-7213951625251464843750,-45971304847383611623535156250],[-15791884530719,215590247115509882609,47356053770269104960937500000,267209078469608433644877041015625000],[-4297028635679,273245445614272103119,-31086555719505380859375000000,336139610899237512350800781250000000],[-2643503216399,2268775635162902551,11546728087630519379232000,-85635963507759515483489729262000],[-2050725512399,2503393124571084151,-32808309228897901590528000,10527906496380473534819292288000],[-2009059703519,928052307259830525871,4370829531085326660316875000,-132043020094452069528753363266250000],[-172636530239,36481379719206079,10990213851046510080000,-20351116098435454214056200000],[90869596801,2892831627474105569,14353334880907751993013750,109870671855133255206080231606250],[777877744561,414540923458135159,-366533137580433408000,780690217311844677631872000],[1816339826401,8432560063739880271,19590675599909872252080000,-19187138391597119845216063125000],[5021358420241,11355170114352267161,-18180573015720211200000000,43898147778895338596382000000000],[5109519582241,10636589947593682961,9739924157430697230000000,15877515421679104665502363125000],[5953059888241,6681824907861688361,3579464269632150900000000,29152227758902247320950768750000],[6238363166401,7938132872141753729,3236090384489120196480000,26451732945969965354172683400000],[9611055255601,46287891979495111351,391702997252051856949500,-3204702406547240661097032874500],[12279421902241,27720894398734429039,-425954713866501456000000,3620409974473702743642699000000],[39692690076481,331597027847041232129,-35818527818850527123919000000,231576669217926136204209911646000000],[65296985676481,79686679571018607871,-14234483439565966811359125000,215548932399207542218235190489750000],[66229041888241,966123794833267480361,-3770751561810925268769192000,-121242671841971574307516832737398000],[78382940363041,756916712213286003281,-4269947122294874733733020000,192145443498572255960645822757975000],[80953658652241,681355493422927507961,19342799175023763549311448000,-144964503820539017136574047507798000],[156378318576481,2891757867604992417871,668960409796861607461968750,-548321236899155371003203061031250],[171444930234481,2476832707269627554071,2374777240299077243175000000,-24539275058581066566182900906250000],[176347394664241,2341367101973956253239,-720057292073437500,10779012088755395976562500],[181261323514321,2204992895776892018119,-2142006574417084019531250000,38820796857202495975770023437500000],[318773367269761,32381926358083761671009,-15752110470557433151245117187500,-868638502514177650580196769409179687500],[716020592969761,9259817782446032741009,39068667020133440886840820312500,-479963258886280000703213600463867187500],[749182931689441,20205776948886980402959,-2628609975788326313355000,107301661049562895558152391050000],[1280229737149441,45784496937026387091041,133448568384332221020000,10959940733681371231185600825000],[1290253363788241,45030776685898747426361,2281294577820526632000,187475809071605186449616598000],[2090861907556801,229217014882869168324799,259860698678255081176757812500,-11734750191947142539262771606445312500],[2821415499364321,149863425020255723903119,-12854254237976074218750,687930909813884731750488281250],[3566441356769761,64594205130502291878991,-208386780734661849975585937500,20659430027572340314516957397460937500],[10787852211364321,967263215211677497896881,62734725963892505710687500,57993315830416929896354365476187500]]:[[[65547662,186088592,128433191,-64326466,-83931727,1638800,13351800],[]],[[20593634,56779779,20285401,-60561897,-43318165,15834654,14486913],[1,0,1]],[[27753489012969500,-3965350226128540,-5577774411806873,2383780859621458,383895383453733,-141921279614160,-13998590382150],[]],[[5556759752250,-788738413680,4612486177957,724970578378,-33025768197,13086749880],[]],[[303714,183237,-3146088,3533780,-1315971,965284,99200],[0,1]],[[87657000,74954615,10981348,-8268298,-1419613,540920,-29200],[0,1]],[[94526173377680,-109143467497240,-24825829909683,30873663756331,9663252325078,279760981335,-94867674825],[]],[[26377406,897512,-17964,-14336,-591,36],[1,1]],[[-14888151,15987526,21250231,-28553124,-3115068,12719520,-3593700],[]],[[-52736352615,-5296301271,95583749700,72099330273,30827940421,51902349168,18636177124],[]],[[55566,-52479,-4153,26509,542,-5502,-484],[0,1,0,1]],[[25272203580,-1733934465,-10107672552,-1573340553,94564362,-2543340,30360],[]],[[285519502,245136191,60674336,10369307,-6817144,123056,82432],[]],[[-47592798840171,2246599583786,167545241670,10623193844,-64732875,-31212],[0,1]],[[-1426127118,6247334691,-2357698353,-7611753951,394796763,3626008032,1248827136],[]],[[567642357681628554,846935653055428864,501866957393141457,337856579389595328,-24352780098415748,580249916078784,-16158238987611],[]],[[1130927595,-3107338185,-674720837,4004241241,-728081634,-1289972852,447323992],[]],[[-2613297314443538844,-364298945048148573,583318852407178527,338684055727538001,-60716960239796267,-24844719544521888,-769057157269676],[]],[[159812096,-31214288,29960840,-17885,732452,461335,51450],[]],[[-4944139200,-988502480,-348974213,-93746309,-5330940,-1997568],[]],[[-563200,-1365088,12595995,8134531,-2538620,37632],[]],[[66872592000,257211051600,-231221088768,-334049492655,192575059755,105947017104,-47255655744],[]],[[26995815,312497010,901862787,-27974884,-127355396,22455888,-398772],[]],[[0,-12240,180313,49103,3027,45],[]],[[47930149556,51352743617,105113059844,93250289094,84528342763,20817706200,2811394800],[1,1]],[[-31328393125444,5708138893520,38221832260,-17264683197,-18596097,11200365],[1,0,1]],[[-1036838796180,1018546744600,94572620483,-198528405317,-862801951,10448613736,327868772],[]],[[-156866019813697437391995,2431970648645495995845,-170431570428538318368,798354064322534453,-64796452020438803,24685137586704,-7648587339036],[]],[[75822214860,16889594400,100156012887,-14014006909,17657928694,-11544115737,1170181233],[]],[[403712414454825,1269905473345950,1230838424020303,348869665748724,-44477767608252,-25273194289200,2905600218300],[]],[[11505620308,-1110309680,-3430826507,673991145,266914875,-65652840,3429324],[]],[[71014156,238250272,129513463,-116732616,19388442,-739944,8127],[]],[[0,198900,898257,1119920,254112,-153783,12668],[0,0,1,1]],[[2756019319068,10585120385028,-14158565315705,-822232755382,113328617577,-726328960,29978200],[]],[[19138501800,-17614661760,-3925778487,-4930107558,1711371091,260464968,119935296],[]],[[-3544409160856896,5348703823681588,-1834229892458423,-414514275788064,240931153072364,4921453165882,-7567527487714],[0,0,1,1]],[[-242892675,4492640115,-7599511698,3453346255,62289235,-108082872,-7215684],[]],[[1525176420,-4896833680,4883440917,-730808493,-1132041254,247158399,103756923],[]],[[10972,-198244,955671,-557638,96841,1956,-858],[]],[[437500,-296000,-169148,56004,33591,4554,189],[]],[[5031011417696,42044864882072,112596133962171,107807504211622,12444742138825,-17124327450000,1924003125000],[]],[[8308818378238950,76776594836455800,210183682934911807,195478065967682014,31303481897976057,-554145008278400,2330410805800],[]]]:[[0,0,4,4,0,0,0,4,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,4,0,4],[0,0,0,0,4,4,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,4,0,0,0,0,0,4,0,0,0,0],[4,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,4,0,0,2,0,4,0,0,0,0,0,4,0],[4,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,4,0,0,2,4,0,0,0,0,0,0,4,0],[0,4,0,0,0,0,0,2,0,0,0,0,4,0,0,0,0,0,0,0,4,0,4,2,0,2,0,0,4,0,0,0,4,0,0,0,0,0,0,0,0,0],[0,4,0,0,0,0,0,0,0,0,2,4,0,0,0,0,0,0,4,0,0,0,4,2,2,0,4,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,4,0,0,0,4,0,4,0,4,0,0,2,0,0,4,0,0,2,0,0,0,0,0,0,0,0,0,4,2,0,0,0,0],[4,0,0,4,2,0,0,0,4,4,0,0,0,4,0,0,0,0,0,4,2,0,0,4,0,4,0,0,0,0,0,0,2,0,4,0,0,0,4,0,0,0],[0,0,0,0,0,0,0,4,0,4,0,0,0,0,4,4,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0],[0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,4,0,0,2,4,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[4,0,4,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,4,4,0,0,0,0,0,0,0,2,4,0,0,0,0,4,0,0,0],[0,4,0,0,0,4,0,0,0,0,0,0,0,0,2,0,4,0,0,0,4,2,0,2,0,0,0,0,4,0,4,0,0,0,0,0,0,0,0,0,0,0],[0,4,0,0,4,0,0,0,0,0,0,0,0,0,0,0,4,0,4,0,0,0,0,2,0,0,4,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,4,2,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,4,0,0,2,0,0,0,4,2,4,0,4,2,4,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,4,0,4,0,0,0,0,4,4,0,0,0,0,0,2,0,0,0,0,4,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,4,4,0,2,0,0,0,4,0,4,2,4,2,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,4,0,0,4,0,0,0,0,4,0,0,0,0,4,2,0,0,0,0,4,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0],[0,0,0,0,0,4,0,0,0,0,2,0,4,0,0,0,4,0,0,0,0,0,0,2,2,0,0,0,4,0,0,0,4,0,0,0,0,4,0,0,0,0],[0,0,0,0,0,0,0,4,0,0,0,0,0,4,4,0,0,4,0,0,2,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,4,0,0,0,0,0],[0,0,0,0,4,0,2,2,2,2,0,4,0,2,2,2,4,2,0,2,0,2,0,2,0,2,4,2,0,0,0,0,4,0,0,2,2,4,0,0,0,0],[0,0,0,0,0,0,0,0,0,4,0,2,0,4,4,0,2,0,0,0,2,0,0,4,0,0,0,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0],[0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,2,0,0,4,0,4,0,0,4,0,0,0,0,0,0,0,0,0,0],[0,2,0,0,2,2,4,4,0,0,4,2,2,0,4,0,2,0,2,0,2,4,2,0,4,4,2,0,2,4,2,2,2,0,0,0,4,2,0,4,0,0],[0,0,0,4,0,2,0,0,0,0,4,0,0,0,0,0,0,0,2,0,0,0,0,4,0,0,0,0,0,0,0,0,2,0,4,0,0,0,0,0,4,4],[0,0,4,0,2,0,0,4,0,0,0,0,0,0,0,4,0,4,0,0,2,0,0,4,0,0,0,4,0,0,0,0,2,4,0,4,0,0,0,0,4,4],[0,0,0,0,0,4,2,0,0,0,0,0,4,0,0,0,0,0,0,0,4,0,4,2,0,0,0,0,0,0,4,0,0,0,0,0,2,4,0,0,0,0],[0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,4,0,0,0,4,2,4,0,0,0,4,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0],[0,0,0,0,4,0,0,0,0,0,0,4,0,0,0,0,0,0,4,0,0,0,4,2,0,0,0,0,0,0,4,0,0,0,0,0,0,4,0,0,0,0],[0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,2,2,2,4,4,0,0,0,0,4,0,0],[0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,2,0,0,4,0,4,2,0,4,4,0,0,0,0,0,0,2,0,0],[0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,4,2,0,0,0,0,0,2,4,0,4,0,0,0,0,4,0,2,0,0],[2,0,2,2,4,4,0,2,0,0,2,0,0,0,0,0,0,0,4,0,4,0,0,2,2,2,0,0,0,2,4,4,0,2,2,0,0,0,2,2,2,2],[0,0,0,4,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,4,0,0,2,0,0,0,0,0,4,0,0,4],[0,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,4,0,0,2,0,0,0,0,0,4,0,0,4],[0,0,0,0,0,0,0,0,4,0,0,0,0,4,0,0,0,4,0,0,2,4,0,0,0,4,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0],[0,0,0,0,0,0,4,0,4,0,0,0,0,0,0,0,0,0,0,4,2,0,0,4,0,0,2,4,0,0,0,0,0,0,0,4,0,2,0,0,0,0],[0,4,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,4,0,4,0,0,2,0,0,4,0,4,0,0,4,0,0,0,0,2,0,0,0,0,0],[0,0,0,0,0,0,0,4,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,4,0,0,0,0,4,4,0],[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,4,2,2,2,0,0,0,0,0,4,0,4,4],[0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,2,0,0,0,0,0,4,4,0,0],[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,2,4,4,0,0,0,0,4,0,0]]
```

# Heuristically verifying the computation
It depends on [CHIMP](https://github.com/edgarcosta/CHIMP) and [smalljac](https://math.mit.edu/~drew/)
(no assert failing means success)
```
magma -b input:="704:704.a:2159575534599616393:[[-1856,129536,-44,-2948]]:[[[-1,-1,-2,1,1,-2],[1,1,1,1]]]:[2,3]:[[-1856,129536,-44,-2948],[771904,687149056,260876,-197548868]]:[[[0,4,4,-1,-2],[0,0,0,1]],[[-1140,-5166,-4646,2135,-236,4],[1]]]:[[0,9],[9,0]]" verify.m
```

